'use strict';

// var Promise = require('bluebird');
// var _ = require('lodash');

var kafka = require('./lib/index');
var producer = new kafka.Producer({
    requiredAcks: 1,
    connectionString: '127.0.0.1:9092,127.0.0.1:9093',
});

return producer.init()
.then(function () {
    return producer.send([
        {
            topic: 'kafka-test-topic',
            partition: 2,
            message: {
                value: new Date().toISOString()
            }
        }
    ]);
})
.then(function () {
    return producer.end();
})
.catch(function (err) {
    kafka.error(err);
    process.exit(255);
});
