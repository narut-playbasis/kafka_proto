'use strict';

var Kafka = require('./lib');

var consumer = new Kafka.GroupConsumer({
});

var strategies = {
    strategy: 'TestStrategy',
    subscriptions: ['kafka-test-topic-1']
};

consumer.on('data', function (messageSet, topic, partition) {
    messageSet.forEach(function (m) {
        console.log(topic, partition, m.offset, m.message.value.toString('utf8'));
        // process each message and commit its offset
        consumer.commitOffset({ topic: topic, partition: partition, offset: m.offset, metadata: 'optional' });
    });
});

return consumer.init(strategies).then(function () {
  // all done, now wait for messages in event listener
});
